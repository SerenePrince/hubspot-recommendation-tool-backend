{
  "info": {
    "name": "HubSpot Recommendation Tool (Backend)",
    "_postman_id": "6c1c12c2-3a0a-4e73-9d44-51c93c19b9a1",
    "description": "Surface-level website technology detection + HubSpot-focused recommendations.\n\n## Purpose\nThis API analyzes a **single public URL** and returns:\n- Technologies detected (surface-level)\n- Categories and groups\n- HubSpot recommendations (config-driven)\n\n## Guardrails\nThis is **not** a recon/scanning tool:\n- No crawling\n- No enumeration\n- No brute forcing\n- No login bypass\n- No private network access (SSRF protections)\n\n## Environment variables used\n- `{{baseUrl}}` (example: http://localhost:3001)\n- `{{exampleUrl}}` (example: https://react.dev/)\n\n## Workflow\n1. Run **Health**\n2. Run **Analyze** (default)\n3. Try Analyze options (pretty / includeMeta)\n4. Validate config locally (`npm run validate-config`)\n5. Use the CLI for deeper inspection:\n- `npm run cli -- {{exampleUrl}} --format human --wrap`\n- `npm run cli:pretty -- {{exampleUrl}}`",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health",
      "description": "Use this folder to confirm the backend is running.\n\n### When to use\n- Before demos\n- After deployment\n- After changing `.env`\n- After updating the vendor dataset\n\n### Expected behavior\n- Should return HTTP 200\n- Response includes `{ ok: true }`",
      "item": [
        {
          "name": "GET /health (default)",
          "description": "Health check endpoint.\n\n### Use case\n- Confirm API is reachable.\n\n### Expected response\n- HTTP 200\n- JSON:\n```json\n{ \"ok\": true }\n```",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/health",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "health"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('HTTP status is 200', function () { pm.response.to.have.status(200); });",
                  "pm.test('Response is JSON', function () { pm.response.to.be.json; });",
                  "const body = pm.response.json();",
                  "pm.test('ok is true', function () { pm.expect(body.ok).to.eql(true); });",
                  "pm.test('service field exists', function () { pm.expect(body).to.have.property('service'); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Analyze",
      "description": "Core endpoint for running a **single-page, surface-level** tech analysis.\n\n## GET /analyze\nThis endpoint:\n1. Fetches a single URL (HTML + headers + cookies + referenced JS/CSS, bounded)\n2. Extracts public signals\n3. Detects technologies using fingerprint patterns\n4. Generates HubSpot recommendations based on detected technologies and categories\n\n## Query parameters\n### pretty\n- `pretty=1` → pretty-printed JSON\n\n### includeMeta\n- `includeMeta=1` → includes lightweight metadata (cache + timings + fetch summary)\n\n## Notes\n- Only one URL is fetched (no crawling).\n- SSRF protections block localhost/private IPs.\n- The analysis result may be cached by URL for a short TTL.",
      "item": [
        {
          "name": "GET /analyze (compact)",
          "description": "Lightweight, frontend-friendly analyze endpoint (GET).",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/analyze?url={{exampleUrl}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "analyze"
              ],
              "query": [
                {
                  "key": "url",
                  "value": "{{exampleUrl}}"
                }
              ]
            },
            "description": "Core endpoint for running a **single-page, surface-level** tech analysis.\n\n## GET /analyze\nThis endpoint:\n1. Fetches a single URL (HTML + headers + cookies + referenced JS/CSS, bounded)\n2. Extracts public signals\n3. Detects technologies using fingerprint patterns\n4. Generates HubSpot recommendations based on detected technologies and categories\n\n## Query parameters\n### pretty\n- `pretty=1` → pretty-printed JSON\n\n### includeMeta\n- `includeMeta=1` → includes lightweight metadata (cache + timings + fetch summary)\n\n## Notes\n- Only one URL is fetched (no crawling).\n- SSRF protections block localhost/private IPs.\n- The analysis result may be cached by URL for a short TTL."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"HTTP status is 200\", function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is valid JSON\", function () {",
                  "  pm.expect(() => pm.response.json()).to.not.throw();",
                  "});",
                  "",
                  "const body = pm.response.json();",
                  "",
                  "pm.test(\"ok is true\", function () {",
                  "  pm.expect(body).to.have.property(\"ok\");",
                  "  pm.expect(body.ok).to.eql(true);",
                  "});",
                  "",
                  "pm.test(\"apiVersion is 2.0\", function () {",
                  "  pm.expect(body).to.have.property(\"apiVersion\");",
                  "  pm.expect(body.apiVersion).to.eql(\"2.0\");",
                  "});",
                  "",
                  "pm.test(\"response has core top-level fields\", function () {",
                  "  pm.expect(body).to.have.property(\"url\");",
                  "  pm.expect(body.url).to.be.a(\"string\");",
                  "",
                  "  pm.expect(body).to.have.property(\"finalUrl\");",
                  "  if (body.finalUrl !== null) {",
                  "    pm.expect(body.finalUrl).to.be.a(\"string\");",
                  "  }",
                  "",
                  "  pm.expect(body).to.have.property(\"technologies\");",
                  "  pm.expect(body.technologies).to.be.an(\"array\");",
                  "",
                  "  pm.expect(body).to.have.property(\"byGroup\");",
                  "  pm.expect(body.byGroup).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body).to.have.property(\"recommendations\");",
                  "  pm.expect(body.recommendations).to.be.an(\"array\");",
                  "",
                  "  pm.expect(body).to.have.property(\"summary\");",
                  "  pm.expect(body.summary).to.be.an(\"object\");",
                  "",
                  "  // meta is optional, only present when includeMeta=1",
                  "  if (body.meta !== undefined && body.meta !== null) {",
                  "    pm.expect(body.meta).to.be.an(\"object\");",
                  "  }",
                  "});",
                  "",
                  "pm.test(\"technologies items have expected fields (including hubspot)\", function () {",
                  "  body.technologies.forEach((t) => {",
                  "    pm.expect(t).to.have.property(\"name\");",
                  "    pm.expect(t.name).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"confidence\");",
                  "    pm.expect(t.confidence).to.be.a(\"number\");",
                  "",
                  "    pm.expect(t).to.have.property(\"version\");",
                  "    if (t.version !== null) pm.expect(t.version).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"description\");",
                  "    if (t.description !== null) pm.expect(t.description).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"website\");",
                  "    if (t.website !== null) pm.expect(t.website).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"icon\");",
                  "    if (t.icon !== null) pm.expect(t.icon).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"categories\");",
                  "    pm.expect(t.categories).to.be.an(\"array\");",
                  "",
                  "    pm.expect(t).to.have.property(\"groups\");",
                  "    pm.expect(t.groups).to.be.an(\"array\");",
                  "",
                  "    pm.expect(t).to.have.property(\"hubspot\");",
                  "    pm.expect(t.hubspot).to.be.an(\"object\");",
                  "",
                  "    pm.expect(t.hubspot).to.have.property(\"primaryProduct\");",
                  "    if (t.hubspot.primaryProduct !== null) {",
                  "      pm.expect(t.hubspot.primaryProduct).to.be.a(\"string\");",
                  "    }",
                  "",
                  "    pm.expect(t.hubspot).to.have.property(\"products\");",
                  "    pm.expect(t.hubspot.products).to.be.an(\"array\");",
                  "",
                  "    if (t.hubspot.products.length > 0) {",
                  "      pm.expect(t.hubspot.primaryProduct).to.eql(t.hubspot.products[0].hubspotProduct);",
                  "    }",
                  "",
                  "    t.hubspot.products.forEach((p) => {",
                  "      pm.expect(p).to.have.property(\"hubspotProduct\");",
                  "      pm.expect(p.hubspotProduct).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"priority\");",
                  "      pm.expect(p.priority).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"title\");",
                  "      if (p.title !== null) pm.expect(p.title).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"description\");",
                  "      if (p.description !== null) pm.expect(p.description).to.be.a(\"string\");",
                  "    });",
                  "  });",
                  "});",
                  "",
                  "pm.test(\"recommendations items have expected fields (v2)\", function () {",
                  "  body.recommendations.forEach((r) => {",
                  "    pm.expect(r).to.have.property(\"title\");",
                  "    pm.expect(r.title).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"hubspotProduct\");",
                  "    pm.expect(r.hubspotProduct).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"priority\");",
                  "    pm.expect(r.priority).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"description\");",
                  "    if (r.description !== null) pm.expect(r.description).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"url\");",
                  "    if (r.url !== null) pm.expect(r.url).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"tags\");",
                  "    pm.expect(r.tags).to.be.an(\"array\");",
                  "",
                  "    pm.expect(r).to.have.property(\"triggeredBy\");",
                  "    pm.expect(r.triggeredBy).to.be.an(\"array\");",
                  "",
                  "    pm.expect(r).to.have.property(\"triggeredBySummary\");",
                  "    if (r.triggeredBySummary !== null) pm.expect(r.triggeredBySummary).to.be.a(\"string\");",
                  "",
                  "    r.triggeredBy.forEach((t) => {",
                  "      pm.expect(t).to.have.property(\"triggerType\");",
                  "      if (t.triggerType !== null) pm.expect(t.triggerType).to.be.a(\"string\");",
                  "",
                  "      pm.expect(t).to.have.property(\"key\");",
                  "      if (t.key !== null) pm.expect(t.key).to.be.a(\"string\");",
                  "",
                  "      pm.expect(t).to.have.property(\"matched\");",
                  "      if (t.matched !== null) pm.expect(t.matched).to.be.a(\"string\");",
                  "    });",
                  "",
                  "    pm.expect(r).to.not.have.property(\"reason\");",
                  "    pm.expect(r).to.not.have.property(\"inboxOffer\");",
                  "  });",
                  "});",
                  "",
                  "pm.test(\"summary has totals + topRecommendations\", function () {",
                  "  pm.expect(body.summary).to.have.property(\"totals\");",
                  "  pm.expect(body.summary.totals).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"technologiesDetected\");",
                  "  pm.expect(body.summary.totals.technologiesDetected).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"recommendations\");",
                  "  pm.expect(body.summary.totals.recommendations).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"mappedReplacements\");",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.have.property(\"technologiesWithReplacements\");",
                  "  pm.expect(body.summary.totals.mappedReplacements.technologiesWithReplacements).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.have.property(\"totalTechnologies\");",
                  "  pm.expect(body.summary.totals.mappedReplacements.totalTechnologies).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary).to.have.property(\"topRecommendations\");",
                  "  pm.expect(body.summary.topRecommendations).to.be.an(\"array\");",
                  "});",
                  "",
                  "pm.test(\"byGroup is consistent with technologies\", function () {",
                  "  Object.keys(body.byGroup).forEach((groupName) => {",
                  "    pm.expect(body.byGroup[groupName]).to.be.an(\"array\");",
                  "    body.byGroup[groupName].forEach((item) => {",
                  "      pm.expect(item).to.have.property(\"name\");",
                  "      pm.expect(item.name).to.be.a(\"string\");",
                  "",
                  "      pm.expect(item).to.have.property(\"confidence\");",
                  "      pm.expect(item.confidence).to.be.a(\"number\");",
                  "",
                  "      pm.expect(item).to.have.property(\"version\");",
                  "      if (item.version !== null) pm.expect(item.version).to.be.a(\"string\");",
                  "    });",
                  "  });",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "GET /analyze?pretty=1 (compact)",
          "description": "Lightweight, frontend-friendly analyze endpoint (GET).",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/analyze?url={{exampleUrl}}&pretty=1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "analyze"
              ],
              "query": [
                {
                  "key": "url",
                  "value": "{{exampleUrl}}"
                },
                {
                  "key": "pretty",
                  "value": "1"
                }
              ]
            },
            "description": "Core endpoint for running a **single-page, surface-level** tech analysis.\n\n## GET /analyze\nThis endpoint:\n1. Fetches a single URL (HTML + headers + cookies + referenced JS/CSS, bounded)\n2. Extracts public signals\n3. Detects technologies using fingerprint patterns\n4. Generates HubSpot recommendations based on detected technologies and categories\n\n## Query parameters\n### pretty\n- `pretty=1` → pretty-printed JSON\n\n### includeMeta\n- `includeMeta=1` → includes lightweight metadata (cache + timings + fetch summary)\n\n## Notes\n- Only one URL is fetched (no crawling).\n- SSRF protections block localhost/private IPs.\n- The analysis result may be cached by URL for a short TTL."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"HTTP status is 200\", function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is valid JSON\", function () {",
                  "  pm.expect(() => pm.response.json()).to.not.throw();",
                  "});",
                  "",
                  "const body = pm.response.json();",
                  "",
                  "pm.test(\"ok is true\", function () {",
                  "  pm.expect(body).to.have.property(\"ok\");",
                  "  pm.expect(body.ok).to.eql(true);",
                  "});",
                  "",
                  "pm.test(\"apiVersion is 2.0\", function () {",
                  "  pm.expect(body).to.have.property(\"apiVersion\");",
                  "  pm.expect(body.apiVersion).to.eql(\"2.0\");",
                  "});",
                  "",
                  "pm.test(\"response has core top-level fields\", function () {",
                  "  pm.expect(body).to.have.property(\"url\");",
                  "  pm.expect(body.url).to.be.a(\"string\");",
                  "",
                  "  pm.expect(body).to.have.property(\"finalUrl\");",
                  "  if (body.finalUrl !== null) {",
                  "    pm.expect(body.finalUrl).to.be.a(\"string\");",
                  "  }",
                  "",
                  "  pm.expect(body).to.have.property(\"technologies\");",
                  "  pm.expect(body.technologies).to.be.an(\"array\");",
                  "",
                  "  pm.expect(body).to.have.property(\"byGroup\");",
                  "  pm.expect(body.byGroup).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body).to.have.property(\"recommendations\");",
                  "  pm.expect(body.recommendations).to.be.an(\"array\");",
                  "",
                  "  pm.expect(body).to.have.property(\"summary\");",
                  "  pm.expect(body.summary).to.be.an(\"object\");",
                  "",
                  "  // meta is optional, only present when includeMeta=1",
                  "  if (body.meta !== undefined && body.meta !== null) {",
                  "    pm.expect(body.meta).to.be.an(\"object\");",
                  "  }",
                  "});",
                  "",
                  "pm.test(\"technologies items have expected fields (including hubspot)\", function () {",
                  "  body.technologies.forEach((t) => {",
                  "    pm.expect(t).to.have.property(\"name\");",
                  "    pm.expect(t.name).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"confidence\");",
                  "    pm.expect(t.confidence).to.be.a(\"number\");",
                  "",
                  "    pm.expect(t).to.have.property(\"version\");",
                  "    if (t.version !== null) pm.expect(t.version).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"description\");",
                  "    if (t.description !== null) pm.expect(t.description).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"website\");",
                  "    if (t.website !== null) pm.expect(t.website).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"icon\");",
                  "    if (t.icon !== null) pm.expect(t.icon).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"categories\");",
                  "    pm.expect(t.categories).to.be.an(\"array\");",
                  "",
                  "    pm.expect(t).to.have.property(\"groups\");",
                  "    pm.expect(t.groups).to.be.an(\"array\");",
                  "",
                  "    pm.expect(t).to.have.property(\"hubspot\");",
                  "    pm.expect(t.hubspot).to.be.an(\"object\");",
                  "",
                  "    pm.expect(t.hubspot).to.have.property(\"primaryProduct\");",
                  "    if (t.hubspot.primaryProduct !== null) {",
                  "      pm.expect(t.hubspot.primaryProduct).to.be.a(\"string\");",
                  "    }",
                  "",
                  "    pm.expect(t.hubspot).to.have.property(\"products\");",
                  "    pm.expect(t.hubspot.products).to.be.an(\"array\");",
                  "",
                  "    if (t.hubspot.products.length > 0) {",
                  "      pm.expect(t.hubspot.primaryProduct).to.eql(t.hubspot.products[0].hubspotProduct);",
                  "    }",
                  "",
                  "    t.hubspot.products.forEach((p) => {",
                  "      pm.expect(p).to.have.property(\"hubspotProduct\");",
                  "      pm.expect(p.hubspotProduct).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"priority\");",
                  "      pm.expect(p.priority).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"title\");",
                  "      if (p.title !== null) pm.expect(p.title).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"description\");",
                  "      if (p.description !== null) pm.expect(p.description).to.be.a(\"string\");",
                  "    });",
                  "  });",
                  "});",
                  "",
                  "pm.test(\"recommendations items have expected fields (v2)\", function () {",
                  "  body.recommendations.forEach((r) => {",
                  "    pm.expect(r).to.have.property(\"title\");",
                  "    pm.expect(r.title).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"hubspotProduct\");",
                  "    pm.expect(r.hubspotProduct).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"priority\");",
                  "    pm.expect(r.priority).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"description\");",
                  "    if (r.description !== null) pm.expect(r.description).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"url\");",
                  "    if (r.url !== null) pm.expect(r.url).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"tags\");",
                  "    pm.expect(r.tags).to.be.an(\"array\");",
                  "",
                  "    pm.expect(r).to.have.property(\"triggeredBy\");",
                  "    pm.expect(r.triggeredBy).to.be.an(\"array\");",
                  "",
                  "    pm.expect(r).to.have.property(\"triggeredBySummary\");",
                  "    if (r.triggeredBySummary !== null) pm.expect(r.triggeredBySummary).to.be.a(\"string\");",
                  "",
                  "    r.triggeredBy.forEach((t) => {",
                  "      pm.expect(t).to.have.property(\"triggerType\");",
                  "      if (t.triggerType !== null) pm.expect(t.triggerType).to.be.a(\"string\");",
                  "",
                  "      pm.expect(t).to.have.property(\"key\");",
                  "      if (t.key !== null) pm.expect(t.key).to.be.a(\"string\");",
                  "",
                  "      pm.expect(t).to.have.property(\"matched\");",
                  "      if (t.matched !== null) pm.expect(t.matched).to.be.a(\"string\");",
                  "    });",
                  "",
                  "    pm.expect(r).to.not.have.property(\"reason\");",
                  "    pm.expect(r).to.not.have.property(\"inboxOffer\");",
                  "  });",
                  "});",
                  "",
                  "pm.test(\"summary has totals + topRecommendations\", function () {",
                  "  pm.expect(body.summary).to.have.property(\"totals\");",
                  "  pm.expect(body.summary.totals).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"technologiesDetected\");",
                  "  pm.expect(body.summary.totals.technologiesDetected).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"recommendations\");",
                  "  pm.expect(body.summary.totals.recommendations).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"mappedReplacements\");",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.have.property(\"technologiesWithReplacements\");",
                  "  pm.expect(body.summary.totals.mappedReplacements.technologiesWithReplacements).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.have.property(\"totalTechnologies\");",
                  "  pm.expect(body.summary.totals.mappedReplacements.totalTechnologies).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary).to.have.property(\"topRecommendations\");",
                  "  pm.expect(body.summary.topRecommendations).to.be.an(\"array\");",
                  "});",
                  "",
                  "pm.test(\"byGroup is consistent with technologies\", function () {",
                  "  Object.keys(body.byGroup).forEach((groupName) => {",
                  "    pm.expect(body.byGroup[groupName]).to.be.an(\"array\");",
                  "    body.byGroup[groupName].forEach((item) => {",
                  "      pm.expect(item).to.have.property(\"name\");",
                  "      pm.expect(item.name).to.be.a(\"string\");",
                  "",
                  "      pm.expect(item).to.have.property(\"confidence\");",
                  "      pm.expect(item.confidence).to.be.a(\"number\");",
                  "",
                  "      pm.expect(item).to.have.property(\"version\");",
                  "      if (item.version !== null) pm.expect(item.version).to.be.a(\"string\");",
                  "    });",
                  "  });",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "GET /analyze?includeMeta=1 (compact + meta)",
          "description": "Lightweight, frontend-friendly analyze endpoint (GET).",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/analyze?url={{exampleUrl}}&includeMeta=1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "analyze"
              ],
              "query": [
                {
                  "key": "url",
                  "value": "{{exampleUrl}}"
                },
                {
                  "key": "includeMeta",
                  "value": "1"
                }
              ]
            },
            "description": "Core endpoint for running a **single-page, surface-level** tech analysis.\n\n## GET /analyze\nThis endpoint:\n1. Fetches a single URL (HTML + headers + cookies + referenced JS/CSS, bounded)\n2. Extracts public signals\n3. Detects technologies using fingerprint patterns\n4. Generates HubSpot recommendations based on detected technologies and categories\n\n## Query parameters\n### pretty\n- `pretty=1` → pretty-printed JSON\n\n### includeMeta\n- `includeMeta=1` → includes lightweight metadata (cache + timings + fetch summary)\n\n## Notes\n- Only one URL is fetched (no crawling).\n- SSRF protections block localhost/private IPs.\n- The analysis result may be cached by URL for a short TTL."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"HTTP status is 200\", function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is valid JSON\", function () {",
                  "  pm.expect(() => pm.response.json()).to.not.throw();",
                  "});",
                  "",
                  "const body = pm.response.json();",
                  "",
                  "pm.test(\"ok is true\", function () {",
                  "  pm.expect(body).to.have.property(\"ok\");",
                  "  pm.expect(body.ok).to.eql(true);",
                  "});",
                  "",
                  "pm.test(\"apiVersion is 2.0\", function () {",
                  "  pm.expect(body).to.have.property(\"apiVersion\");",
                  "  pm.expect(body.apiVersion).to.eql(\"2.0\");",
                  "});",
                  "",
                  "pm.test(\"response has core top-level fields\", function () {",
                  "  pm.expect(body).to.have.property(\"url\");",
                  "  pm.expect(body.url).to.be.a(\"string\");",
                  "",
                  "  pm.expect(body).to.have.property(\"finalUrl\");",
                  "  if (body.finalUrl !== null) {",
                  "    pm.expect(body.finalUrl).to.be.a(\"string\");",
                  "  }",
                  "",
                  "  pm.expect(body).to.have.property(\"technologies\");",
                  "  pm.expect(body.technologies).to.be.an(\"array\");",
                  "",
                  "  pm.expect(body).to.have.property(\"byGroup\");",
                  "  pm.expect(body.byGroup).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body).to.have.property(\"recommendations\");",
                  "  pm.expect(body.recommendations).to.be.an(\"array\");",
                  "",
                  "  pm.expect(body).to.have.property(\"summary\");",
                  "  pm.expect(body.summary).to.be.an(\"object\");",
                  "",
                  "  // meta is optional, only present when includeMeta=1",
                  "  if (body.meta !== undefined && body.meta !== null) {",
                  "    pm.expect(body.meta).to.be.an(\"object\");",
                  "  }",
                  "});",
                  "",
                  "pm.test(\"technologies items have expected fields (including hubspot)\", function () {",
                  "  body.technologies.forEach((t) => {",
                  "    pm.expect(t).to.have.property(\"name\");",
                  "    pm.expect(t.name).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"confidence\");",
                  "    pm.expect(t.confidence).to.be.a(\"number\");",
                  "",
                  "    pm.expect(t).to.have.property(\"version\");",
                  "    if (t.version !== null) pm.expect(t.version).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"description\");",
                  "    if (t.description !== null) pm.expect(t.description).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"website\");",
                  "    if (t.website !== null) pm.expect(t.website).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"icon\");",
                  "    if (t.icon !== null) pm.expect(t.icon).to.be.a(\"string\");",
                  "",
                  "    pm.expect(t).to.have.property(\"categories\");",
                  "    pm.expect(t.categories).to.be.an(\"array\");",
                  "",
                  "    pm.expect(t).to.have.property(\"groups\");",
                  "    pm.expect(t.groups).to.be.an(\"array\");",
                  "",
                  "    pm.expect(t).to.have.property(\"hubspot\");",
                  "    pm.expect(t.hubspot).to.be.an(\"object\");",
                  "",
                  "    pm.expect(t.hubspot).to.have.property(\"primaryProduct\");",
                  "    if (t.hubspot.primaryProduct !== null) {",
                  "      pm.expect(t.hubspot.primaryProduct).to.be.a(\"string\");",
                  "    }",
                  "",
                  "    pm.expect(t.hubspot).to.have.property(\"products\");",
                  "    pm.expect(t.hubspot.products).to.be.an(\"array\");",
                  "",
                  "    if (t.hubspot.products.length > 0) {",
                  "      pm.expect(t.hubspot.primaryProduct).to.eql(t.hubspot.products[0].hubspotProduct);",
                  "    }",
                  "",
                  "    t.hubspot.products.forEach((p) => {",
                  "      pm.expect(p).to.have.property(\"hubspotProduct\");",
                  "      pm.expect(p.hubspotProduct).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"priority\");",
                  "      pm.expect(p.priority).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"title\");",
                  "      if (p.title !== null) pm.expect(p.title).to.be.a(\"string\");",
                  "",
                  "      pm.expect(p).to.have.property(\"description\");",
                  "      if (p.description !== null) pm.expect(p.description).to.be.a(\"string\");",
                  "    });",
                  "  });",
                  "});",
                  "",
                  "pm.test(\"recommendations items have expected fields (v2)\", function () {",
                  "  body.recommendations.forEach((r) => {",
                  "    pm.expect(r).to.have.property(\"title\");",
                  "    pm.expect(r.title).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"hubspotProduct\");",
                  "    pm.expect(r.hubspotProduct).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"priority\");",
                  "    pm.expect(r.priority).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"description\");",
                  "    if (r.description !== null) pm.expect(r.description).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"url\");",
                  "    if (r.url !== null) pm.expect(r.url).to.be.a(\"string\");",
                  "",
                  "    pm.expect(r).to.have.property(\"tags\");",
                  "    pm.expect(r.tags).to.be.an(\"array\");",
                  "",
                  "    pm.expect(r).to.have.property(\"triggeredBy\");",
                  "    pm.expect(r.triggeredBy).to.be.an(\"array\");",
                  "",
                  "    pm.expect(r).to.have.property(\"triggeredBySummary\");",
                  "    if (r.triggeredBySummary !== null) pm.expect(r.triggeredBySummary).to.be.a(\"string\");",
                  "",
                  "    r.triggeredBy.forEach((t) => {",
                  "      pm.expect(t).to.have.property(\"triggerType\");",
                  "      if (t.triggerType !== null) pm.expect(t.triggerType).to.be.a(\"string\");",
                  "",
                  "      pm.expect(t).to.have.property(\"key\");",
                  "      if (t.key !== null) pm.expect(t.key).to.be.a(\"string\");",
                  "",
                  "      pm.expect(t).to.have.property(\"matched\");",
                  "      if (t.matched !== null) pm.expect(t.matched).to.be.a(\"string\");",
                  "    });",
                  "",
                  "    pm.expect(r).to.not.have.property(\"reason\");",
                  "    pm.expect(r).to.not.have.property(\"inboxOffer\");",
                  "  });",
                  "});",
                  "",
                  "pm.test(\"summary has totals + topRecommendations\", function () {",
                  "  pm.expect(body.summary).to.have.property(\"totals\");",
                  "  pm.expect(body.summary.totals).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"technologiesDetected\");",
                  "  pm.expect(body.summary.totals.technologiesDetected).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"recommendations\");",
                  "  pm.expect(body.summary.totals.recommendations).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals).to.have.property(\"mappedReplacements\");",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.be.an(\"object\");",
                  "",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.have.property(\"technologiesWithReplacements\");",
                  "  pm.expect(body.summary.totals.mappedReplacements.technologiesWithReplacements).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary.totals.mappedReplacements).to.have.property(\"totalTechnologies\");",
                  "  pm.expect(body.summary.totals.mappedReplacements.totalTechnologies).to.be.a(\"number\");",
                  "",
                  "  pm.expect(body.summary).to.have.property(\"topRecommendations\");",
                  "  pm.expect(body.summary.topRecommendations).to.be.an(\"array\");",
                  "});",
                  "",
                  "pm.test(\"byGroup is consistent with technologies\", function () {",
                  "  Object.keys(body.byGroup).forEach((groupName) => {",
                  "    pm.expect(body.byGroup[groupName]).to.be.an(\"array\");",
                  "    body.byGroup[groupName].forEach((item) => {",
                  "      pm.expect(item).to.have.property(\"name\");",
                  "      pm.expect(item.name).to.be.a(\"string\");",
                  "",
                  "      pm.expect(item).to.have.property(\"confidence\");",
                  "      pm.expect(item.confidence).to.be.a(\"number\");",
                  "",
                  "      pm.expect(item).to.have.property(\"version\");",
                  "      if (item.version !== null) pm.expect(item.version).to.be.a(\"string\");",
                  "    });",
                  "  });",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}